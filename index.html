<!-- shamelessly stolen from scott murray: http://alignedleft.com/tutorials -->
<!DOCTYPE html>
<html lang="en">

<style type="text/css">
svg {
  border: 5px solid white;
}

.testbar {
  fill: #ff00ff;
}

.bar {
	fill:#ddd;
}

.g-ESPN{
	fill: orange;
	font-size: 15px;
}

.g-NETWORK{
	fill: grey;
	font-size: 11px;
}

.texth1 {
	font-size: 20px;	

}

.texth2 {
	font-size: 13px;
	color: grey;	

}

.texth3 {
	font-size: 15px;

}

.bottomaxis {
	size: 1px;
	color: black;
} 

.axis line {
    fill: none;
    stroke: black;
    shape-rendering: crispEdges;
}

.axis text {
    font-family: sans-serif;
    font-size: 11px;
}

</style>


    <head>
        <meta charset="utf-8">
        <title>D3 Test</title>
        <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    </head>

    <body>
	
        <script type="text/javascript">
         d3.select("body").append("h1").attr("class","texth1").text("To Protect Its Empire, ESPN Stays on Offense")
		d3.select("body").append("h2").attr("class","texth2").text("ESPNâ€™s average monthly price is more than four times the monthly fee for the next most expensive national network.")
		d3.select("body").append("h2").attr("class","texth2").text("Cost Per Day TV Subscriber per Month")

		var margin = {top: 20, right: 10, bottom: 20, left: 10};

		var width = 800 - margin.left - margin.right,
			height = 350 - margin.top - margin.bottom;
		barPad = 2;

		var svg = d3.select("body").append("svg")
		    .attr("width", width + margin.left + margin.right)
		    .attr("height", height + margin.top + margin.bottom)
		    .append("g")
		    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
		
		//The code below simply makes a rectangle
			//var testRectangle = svg.append("rect")
			  //  .attr("x", 20)
			    //.attr("y", 100)
			    //.attr("height", 50)
			    //.attr("width", 200)
			    //.attr("class", "testbar");
			
	//Loading data into D3		
    d3.csv("subscription-prices.csv", function(err,prices) {
	
		var formatCount = d3.format(",.0f");
			f = d3.format("$.0f"),
			f2 = d3.format("$.2f");
	
	// recasts d.2013 as a number, not a string
	prices.forEach(function(d) {
		
		d.X2013 = +d.X2013;
	    });
	
	prices.sort(function(a,b) {
		return a.X2013 - b.X2013;
		});
	
	var networks = ["C-SPAN", "The Weather Channel", "Comedy Central", "MSNBC","Bravo", "TBS", "ESPN2","TNT"];
	
	var y = d3.scale.linear()
		.domain([0,5.6])
		.range([height,0]);
		
	var x = d3.scale.ordinal()
		.domain(prices.map(function(d){return d.Network}))
		.rangeBands ([0,width],0.5);
		
	//Adding the y-AXis	
	var yAxis = d3.svg.axis()
		             .scale(y)
				     .tickFormat(f)
				     .tickValues([0,1,2,3,4,5])
		             .orient("right");
	
	var bottomyAxis = d3.svg.axis()
					.scale(y)
					.tickValues([0])
					.tickSize(width)
					.orient("right");
	
		
	var bar = svg.selectAll(".bar")
		.data(prices)
		.enter()
		.append("rect")
		.attr("width", width / prices.length - barPad)
		.attr("height", function(d) {return height - y(d.X2013); })
		.attr("y", function(d)  {return y(d.X2013) })
		.attr("x",function(d,i) {return i*(width/prices.length);})
		.attr("class","bar")
		.classed("g-ESPN",function(d){return d.Network == "ESPN"})
		.classed("g-NETWORK",function(d){return networks.indexOf(d.Network) >= 0;});

		//storing the x positioning into a var for use in upcoming functions
		var xpos = 930;
	
	svg.append("text")
	.attr("class","g-label")
		.attr("x",xpos)
		.attr("y",12)
		.text("ESPN");

	svg.append("g").selectAll(".bar")
		.data(prices)
		.enter()
		.append("g")
		.attr("class","g-NETWORK")
		.append("text")
		.attr("id", function(d) {return d.Network.split(" ").join("-") })
		.text(function(d) {return x(d.Network) + 20;})
		.attr("x", function(d) {return x(d.Network) + 20; })
		.attr("y", function(d) {return y(d.X2013)- 10;})
		.attr("transform", "translate(" + -100 + ",0)");
		
	// adds an axis line along the bottom
	svg.append("g")
		.attr("class","bottomaxis")
		.call(bottomyAxis)
		.attr("class","y axis bottomaxis");
		
	// adds the price for the ESPN network to the svg, changes based on csv file
	svg.append("text")
		.text(f2(prices.filter(function(d) {return d.Network =="ESPN"}) [0].X2013)  )
		.attr("x", xpos)
		.attr("y", 28)
		.attr("class", "g-NETWORK");
		
	//adds the "per subscriber" to the svg
	svg.append("text")
		.text("per subscriber")
		.attr("x", xpos)
		.attr("y", 41)
		.attr("class", "g-NETWORK");
		
		d3.select("#C-SPAN")
		   .attr("x", 203);

		d3.select("#The-Weather-Channel")
		   .attr("x", 355);

		d3.select("#Comedy-Central")
		    .attr("x", 535);

	 	d3.select("#MSNBC")
		   	.attr("x", 675);

		 d3.select("#Bravo")
		      .attr("x", 762)
		      .attr("y", 670);

		 d3.select("#TBS")
		      .attr("x", 900)
		      .attr("y", 643);

		d3.select("#TNT")
		  .attr("x", 938)
		  .attr("y", 555);
	
	});	
	
	d3.select("body").append("h2").attr("class","texth3").text("1.If ESPN is an outlier in terms of price, is it also an outlier in terms of viewership? ")
	d3.select("body").append("h2").attr("class","texth3").text("2.How has the price of the top five channels (in terms of viewership) changed over time?")
    d3.select("body").append("h2").attr("class","texth3").text("3. How does customer satisfaction vary according to price?")
			
		
        </script>
    </body>
</html>